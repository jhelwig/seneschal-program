<form class="seneschal-model-selection">
  {{#if error}}
  <div class="notification error">
    <i class="fas fa-exclamation-triangle"></i>
    {{error}}
  </div>
  {{/if}}

  {{#if isLoading}}
  <div class="seneschal-loading">
    <i class="fas fa-spinner fa-spin"></i>
    {{localize "SENESCHAL.Settings.ModelSelection.Loading"}}
  </div>
  {{else}}
  <div class="form-group">
    <label>{{localize "SENESCHAL.Settings.ModelSelection.SelectLabel"}}</label>
    <div class="form-fields">
      <select name="selectedModel">
        <option value="">{{localize "SENESCHAL.Settings.ModelSelection.NoModel"}}</option>
        {{#each models}}
        <option value="{{this.name}}" {{#if (eq this.name ../selectedModel)}}selected{{/if}}>
          {{this.name}}{{#if this.context_length}} ({{this.context_length}} ctx){{/if}}{{#if this.parameter_size}} - {{this.parameter_size}}{{/if}}
        </option>
        {{/each}}
      </select>
    </div>
    <p class="notes">{{localize "SENESCHAL.Settings.ModelSelection.SelectHint"}}</p>
  </div>

  <div class="form-group">
    <label>{{localize "SENESCHAL.Settings.ModelSelection.VisionLabel"}}</label>
    <div class="form-fields">
      <select name="visionModel">
        <option value="">{{localize "SENESCHAL.Settings.ModelSelection.NoModel"}}</option>
        {{#each models}}
        <option value="{{this.name}}" {{#if (eq this.name ../visionModel)}}selected{{/if}}>
          {{this.name}}{{#if this.context_length}} ({{this.context_length}} ctx){{/if}}{{#if this.parameter_size}} - {{this.parameter_size}}{{/if}}
        </option>
        {{/each}}
      </select>
    </div>
    <p class="notes">{{localize "SENESCHAL.Settings.ModelSelection.VisionHint"}}</p>
  </div>

  {{#if models.length}}
  <table class="seneschal-models-table">
    <thead>
      <tr>
        <th>{{localize "SENESCHAL.Settings.ModelSelection.ModelName"}}</th>
        <th>{{localize "SENESCHAL.Settings.ModelSelection.ContextLength"}}</th>
        <th>{{localize "SENESCHAL.Settings.ModelSelection.Parameters"}}</th>
        <th>{{localize "SENESCHAL.Settings.ModelSelection.Quantization"}}</th>
      </tr>
    </thead>
    <tbody>
      {{#each models}}
      <tr>
        <td>{{this.name}}</td>
        <td>{{#if this.context_length}}{{this.context_length}}{{else}}-{{/if}}</td>
        <td>{{#if this.parameter_size}}{{this.parameter_size}}{{else}}-{{/if}}</td>
        <td>{{#if this.quantization}}{{this.quantization}}{{else}}-{{/if}}</td>
      </tr>
      {{/each}}
    </tbody>
  </table>
  {{/if}}
  {{/if}}

  <footer class="sheet-footer flexrow">
    <button type="button" class="seneschal-refresh-models">
      <i class="fas fa-sync"></i> {{localize "SENESCHAL.Settings.ModelSelection.Refresh"}}
    </button>
    <button type="submit">
      <i class="fas fa-save"></i> {{localize "SENESCHAL.Settings.ModelSelection.Save"}}
    </button>
  </footer>
</form>
